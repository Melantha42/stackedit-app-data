


![输入图片说明](/imgs/2025-07-26/x1E4gZyzEwRP85zo.png)
![输入图片说明](/imgs/2025-07-26/uM8BssLRlsZoYMZG.png)
![输入图片说明](/imgs/2025-07-26/cUrrwp5jkkfiXz3I.png)
![输入图片说明](/imgs/2025-07-26/busl996LymtLtnYw.png)
## 系统调用的步骤
![输入图片说明](/imgs/2025-07-26/yNrs1jl7arVar7AU.png)

1.  **用户程序执行系统调用指令**：
    
    用户进程在需要执行特权操作（如访问硬件、文件系统等）时，会执行一条特殊的系统调用指令，如x86架构中的`SYSCALL`或`INT`指令。﻿
    
2.  **处理器硬件介入**：
    
    当CPU执行到这条特权指令时，处理器硬件会自动检测到这一操作。﻿
    
3.  **上下文切换与模式转换**：
    
    **硬件**会执行以下操作：
    
    -   保存用户进程当前的CPU状态，包括程序计数器（PC）和处理器状态字（PSW）等，并将这些信息保存在内核栈中。﻿
        
    -   **将CPU的运行模式从用户态切换到内核态**
        
    -   根据预设的地址，将程序控制流转移到操作系统内核中的系统调用处理入口点。﻿
        
    
4.  **内核处理系统调用**：
    
    CPU现在处于内核态，可以安全地执行操作系统内核中的代码，执行具体的系统调用逻辑，如访问硬件、管理内存、读写文件等。﻿
    
5.  **返回用户态**：
    
    当系统调用完成时，内核会执行一个返回指令（如`SYSRET`或`IRET`），将之前保存的上下文恢复给用户进程，并将CPU模式从内核态切换回用户态，让用户进程恢复执行。




<!--stackedit_data:
eyJoaXN0b3J5IjpbODkxNzc1NDE1LC01NzMxNzI0ODEsLTQzOD
A2MTAwNl19
-->